from scipy.spatial import Voronoi, voronoi_plot_2d
import numpy as np
import random
import math
import heapq
import matplotlib
import matplotlib.pyplot as plt
from vor_utils import *
from scipy.interpolate import UnivariateSpline
import scipy.interpolate as interpolate
from smh_astar import *
import pdb

# pose: 
#   pose: 
#     position: 
px= 0.019715886563062668
py= 1.4044371843338013
pz= 0.0
#     orientation: 
qx= 0.0
qy= 0.0
qz= 0.6813265229028491
qw= 0.7319796234794473

yaw = math.atan2(2 * (qw*qz + qx*qy), 1 - 2 * (qy*qy + qz*qz))


angle_min = -2.3561899662017822
angle_max = 2.3561899662017822
angle_increment = 0.006554075051099062
time_increment = 0.0
scan_time =0.0
range_min = 0.10000000149011612
range_max = 30.0
ranges2 = [2.833653211593628, 2.8102400302886963, 2.7975316047668457, 2.7932779788970947, 2.7919719219207764, 2.70410418510437, 2.68740177154541, 2.675257444381714, 2.6715621948242188, 2.671053647994995, 2.5912857055664062, 2.572967290878296, 2.5605239868164062, 2.5561490058898926, 2.5558583736419678, 2.5565383434295654, 2.4706478118896484, 2.456171751022339, 2.4456334114074707, 2.4433343410491943, 2.4405808448791504, 2.4449844360351562, 2.364546537399292, 2.3490943908691406, 2.338441848754883, 2.332746982574463, 2.3308000564575195, 2.332807779312134, 2.294717311859131, 2.2554290294647217, 2.240403175354004, 2.2307941913604736, 2.2276947498321533, 2.2269022464752197, 2.2291207313537598, 2.232057809829712, 2.1638782024383545, 2.1472434997558594, 2.135958433151245, 2.129424571990967, 2.1262922286987305, 2.1279280185699463, 2.13118839263916, 2.1328442096710205, 2.0733258724212646, 2.054784059524536, 2.044229745864868, 2.037532091140747, 2.0339386463165283, 2.033860921859741, 2.033299684524536, 2.0392544269561768, 2.0473079681396484, 1.9819486141204834, 1.9642770290374756, 1.9548625946044922, 1.9508206844329834, 1.9471379518508911, 1.9459036588668823, 1.9480857849121094, 1.9507626295089722, 1.957933783531189, 1.921404242515564, 1.896451711654663, 1.8830734491348267, 1.8748278617858887, 1.8706053495407104, 1.8669605255126953, 1.8650178909301758, 1.8671833276748657, 1.8714711666107178, 1.8793989419937134, 1.890318751335144, 1.8339258432388306, 1.81753408908844, 1.8079780340194702, 1.8032002449035645, 1.8010437488555908, 1.7985330820083618, 1.7971404790878296, 1.7981592416763306, 1.8034511804580688, 1.8107651472091675, 1.8207358121871948, 1.7761313915252686, 1.758666753768921, 1.7477110624313354, 1.7416962385177612, 1.7379180192947388, 1.7354884147644043, 1.7346959114074707, 1.7386057376861572, 1.7416385412216187, 1.745267629623413, 1.7554889917373657, 1.766764521598816, 1.7238438129425049, 1.7090709209442139, 1.7001545429229736, 1.6927711963653564, 1.6881396770477295, 1.686854362487793, 1.6843955516815186, 1.6856738328933716, 1.6889967918395996, 1.696083664894104, 1.7026541233062744, 1.7142794132232666, 1.7045798301696777, 1.6800432205200195, 1.6647138595581055, 1.6575515270233154, 1.6527704000473022, 1.6480804681777954, 1.6479426622390747, 1.645272970199585, 1.650514006614685, 1.6516578197479248, 1.6572072505950928, 1.6671102046966553, 1.6799904108047485, 1.68294358253479, 1.6528706550598145, 1.6417938470840454, 1.6298086643218994, 1.6268326044082642, 1.6219918727874756, 1.621781587600708, 1.6224910020828247, 1.623467206954956, 1.6250407695770264, 1.630216360092163, 1.6366938352584839, 1.6486597061157227, 1.6674963235855103, 1.650615930557251, 1.6327095031738281, 1.6250215768814087, 1.6172370910644531, 1.6113642454147339, 1.6090123653411865, 1.6066789627075195, 1.6075609922409058, 1.611259937286377, 1.6135081052780151, 1.6217283010482788, 1.6305099725723267, 1.6447982788085938, 1.6750332117080688, 1.6429179906845093, 1.6286277770996094, 1.6201707124710083, 1.614128589630127, 1.6100504398345947, 1.6070417165756226, 1.6081361770629883, 1.6101332902908325, 1.6117262840270996, 1.6177419424057007, 1.6221749782562256, 1.633519172668457, 1.6517812013626099, 1.665629267692566, 1.6488713026046753, 1.6389493942260742, 1.6312254667282104, 1.6256616115570068, 1.623674988746643, 1.620688796043396, 1.6218615770339966, 1.6255019903182983, 1.6297047138214111, 1.634148120880127, 1.642520785331726, 1.6563576459884644, 1.703347086906433, 1.6791208982467651, 1.6681369543075562, 1.658970594406128, 1.6533174514770508, 1.649793028831482, 1.6506630182266235, 1.6508731842041016, 1.6515436172485352, 1.6554728746414185, 1.6612061262130737, 1.6680461168289185, 1.6818139553070068, 1.7149417400360107, 1.71562922000885, 1.70271897315979, 1.6960798501968384, 1.6920874118804932, 1.688874363899231, 1.688629388809204, 1.6880587339401245, 1.6926974058151245, 1.6950864791870117, 1.7031952142715454, 1.7123385667800903, 1.7309976816177368, 1.7692893743515015, 1.7552517652511597, 1.7486486434936523, 1.7431710958480835, 1.7399330139160156, 1.7376636266708374, 1.7404451370239258, 1.7416049242019653, 1.7464176416397095, 1.7560958862304688, 1.7645759582519531, 1.7853899002075195, 1.8237488269805908, 1.8142606019973755, 1.8056224584579468, 1.8007451295852661, 1.8016434907913208, 1.8007632493972778, 1.8022791147232056, 1.8064723014831543, 1.8149547576904297, 1.823110818862915, 1.8395100831985474, 1.8921945095062256, 1.8823139667510986, 1.8755422830581665, 1.8716527223587036, 1.8718998432159424, 1.8709291219711304, 1.8757951259613037, 1.883665680885315, 1.8888753652572632, 1.9042917490005493, 1.9707618951797485, 1.9614677429199219, 1.9541972875595093, 1.9527522325515747, 1.9507343769073486, 1.952171802520752, 1.9556748867034912, 1.9615604877471924, 1.9741685390472412, 1.9962223768234253, 2.049724817276001, 2.040891408920288, 2.038487434387207, 2.0400822162628174, 2.0395407676696777, 2.045029401779175, 2.051800012588501, 2.0653624534606934, 2.090926170349121, 2.1372532844543457, 2.1347711086273193, 2.1323049068450928, 2.132887840270996, 2.0672969818115234, 2.047346591949463, 2.033604860305786, 2.0249717235565186, 2.022752285003662, 2.0195472240448, 2.0216877460479736, 2.025294780731201, 2.0326125621795654, 2.0414204597473145, 2.0599606037139893, 2.130709171295166, 2.1258835792541504, 2.126105308532715, 2.1265106201171875, 2.131472110748291, 2.1438915729522705, 2.1553955078125, 2.2396929264068604, 2.2347023487091064, 2.235480546951294, 2.23744797706604, 2.2435457706451416, 2.173191785812378, 2.156707286834717, 2.1474084854125977, 2.138028144836426, 2.139972686767578, 2.1360762119293213, 2.1411378383636475, 2.1496567726135254, 2.159527063369751, 2.177356719970703, 2.2572858333587646, 2.2587575912475586, 2.260721206665039, 2.2677972316741943, 2.2187259197235107, 2.1960597038269043, 2.1848971843719482, 2.175194501876831, 2.171643018722534, 2.1705470085144043, 2.1753482818603516, 2.1802361011505127, 2.1894731521606445, 2.204535484313965, 2.9915833473205566, 2.9771318435668945, 2.970019578933716, 2.9689390659332275, 2.970386266708374, 2.9820683002471924, 3.0039312839508057, 3.0996408462524414, 3.105375051498413, 3.1205687522888184, 3.169881820678711, 3.57025146484375, 3.5836174488067627, 3.61892032623291, 3.706587076187134, 3.723665714263916, 3.6597390174865723, 3.6437594890594482, 3.634791374206543, 3.63632869720459, 3.6495654582977295, 3.673410415649414, 3.7783477306365967, 3.79733943939209, 3.7409725189208984, 3.7218267917633057, 3.7151405811309814, 3.7173728942871094, 3.727013349533081, 3.215860605239868, 3.197021722793579, 3.1910767555236816, 3.1886820793151855, 3.195483446121216, 3.2080416679382324, 3.1961605548858643, 3.162912130355835, 3.1498591899871826, 3.141174793243408, 3.14274001121521, 3.1498725414276123, 3.1656036376953125, 3.788548231124878, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, 2.300710439682007, 2.281278371810913, 2.268322706222534, 2.2645905017852783, 2.261089324951172, 2.2609150409698486, 2.266017436981201, 2.2712349891662598, 2.2864527702331543, 2.311469793319702, 2.4503073692321777, 2.425405979156494, 2.414384603500366, 2.4072470664978027, 2.4041218757629395, 2.4036402702331543, 2.409986734390259, 2.4185760021209717, 2.4342939853668213, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, 2.1730363368988037, 2.160623073577881, 2.1514229774475098, 2.1454319953918457, 2.144127130508423, 2.1453685760498047, 2.1471991539001465, 2.1562092304229736, 2.1671481132507324, 2.191033124923706, 2.2082746028900146, 2.1921534538269043, 2.075418710708618, 2.05385684967041, 2.0429885387420654, 2.0362043380737305, 2.0329720973968506, 2.030301094055176, 2.0342116355895996, 2.0357563495635986, 2.0462963581085205, 2.0562777519226074, 2.0801100730895996, math.inf, math.inf, 3.881694793701172, 3.848001718521118, 3.8352952003479004, 3.832970142364502, 3.8401012420654297, 3.859166383743286, 3.911970376968384, 3.892651081085205, 3.778515338897705, 3.755849838256836, 3.748872995376587, 3.7474639415740967, 3.757843017578125, 3.7845969200134277, 4.6172895431518555, 4.61716890335083, 4.627771854400635, 4.7082061767578125, 4.680539608001709, 4.679752349853516, 4.686311721801758, 4.715748310089111, math.inf, math.inf, math.inf, math.inf, math.inf, 1.6492948532104492, 1.6272045373916626, 1.6150246858596802, 1.605814814567566, 1.6015167236328125, 1.5985260009765625, 1.5979845523834229, 1.5967415571212769, 1.5978941917419434, 1.6013448238372803, 1.6065623760223389, 1.6133501529693604, 1.6255913972854614, 1.6465938091278076, 1.6948230266571045, 1.6845927238464355, 1.6827524900436401, 1.678379774093628, 1.6811169385910034, 1.680545687675476, 1.6842527389526367, 1.6912686824798584, 1.6967545747756958, 1.7099403142929077, 1.7322503328323364, 3.4846174716949463, 3.480098009109497, 3.417546033859253, 3.381342887878418, 3.36796498298645, 3.365720748901367, 3.36967396736145, 3.375126600265503, 3.400271415710449, 3.635354995727539, 3.8927338123321533, 3.8882548809051514, 3.89272141456604, 3.7982399463653564, 3.7825615406036377, 3.7780442237854004, 3.7815768718719482, 3.6931350231170654, 3.678046464920044, 3.670241117477417, 3.6722586154937744, 3.6037092208862305, 3.579758405685425, 3.5698487758636475, 3.567348003387451, 3.5731306076049805, 3.4931628704071045, 3.47560715675354, 3.467642307281494, 3.468480348587036, 3.476083278656006, 3.3926339149475098, 3.3770699501037598, 3.3702003955841064, 3.370252847671509, 3.380563497543335, 3.3058111667633057, 3.288043260574341, 3.2776808738708496, 3.278104066848755, 3.2831647396087646, 3.236571788787842, 3.207010507583618, 3.1931557655334473, 3.190716505050659, 3.1885857582092285, 3.199399471282959, 3.144632577896118, 3.1201095581054688, 2.93904447555542, 2.9132254123687744, 2.901775360107422, 2.897336006164551, 2.8976263999938965, 2.904232978820801, 2.914888620376587, 2.9423563480377197, 3.0282185077667236, 3.03033185005188, 3.044914722442627, 2.977412223815918, 2.961834192276001, 2.953763484954834, 2.950812339782715, 2.9550867080688477, 2.9647328853607178, 2.937152147293091, 2.905038833618164, 2.8944075107574463, 2.883089780807495, 2.7213149070739746, 2.7006490230560303, 2.688166618347168, 2.6860265731811523, 2.531778335571289, 2.5084636211395264, 2.4946582317352295, 2.4897358417510986, 2.4870619773864746, 2.4885904788970947, 2.49525785446167, 2.000229835510254, 1.9807512760162354, 1.9708971977233887, 1.9626517295837402, 1.9597961902618408, 1.9597880840301514, 1.9612332582473755, 1.8116645812988281, 1.7926454544067383, 1.7844725847244263, 1.7775315046310425, 1.7732508182525635, 1.770753264427185, 1.771605134010315, 1.7721346616744995, 1.7774310111999512, 1.7833751440048218, 1.7923672199249268, 1.809653401374817, 1.927256464958191, 1.9378092288970947, 1.9554928541183472, 2.7034456729888916, 2.6976609230041504, 2.66729736328125, 2.6537926197052, 2.64851975440979, 2.6446235179901123, 2.6478116512298584, 2.6532928943634033, 2.517334461212158, 2.4924545288085938, 2.4822771549224854, 2.473592519760132, 2.472825765609741, 2.471611738204956, 2.4786109924316406, 2.4908719062805176, 2.5071921348571777, 2.655949115753174, 2.644991159439087, 2.6222567558288574, 2.607928991317749, 2.6032652854919434, 2.602205753326416, 2.6060640811920166, 2.614025354385376, 2.62492036819458, 2.659888744354248, 2.6219873428344727, 2.604532241821289, 2.598090410232544, 2.594794273376465, 2.5956015586853027, 2.6015334129333496, 2.6102027893066406, 2.627875328063965, 2.638265609741211, 2.6133501529693604, 2.602632761001587, 2.596745729446411, 2.594899892807007, 2.595935821533203, 2.601940870285034, 2.6163012981414795, 2.643876075744629, 2.634415626525879, 2.6179537773132324, 2.6066043376922607, 2.6028103828430176, 2.6031720638275146, 2.6065175533294678, 2.6152212619781494, 2.633314371109009, 2.6668777465820312, 2.64060378074646, 2.627607822418213, 2.623450517654419, 2.618847131729126, 2.6199402809143066, 2.6286814212799072, 2.6384525299072266, 2.6663331985473633, 2.6733479499816895, 2.655648946762085, 2.6466622352600098, 2.643839120864868, 2.6438708305358887, 2.6493191719055176, 2.6608800888061523, 2.681427478790283, 2.7099313735961914, 2.689723491668701, 2.681018352508545, 2.6768152713775635, 2.677398681640625, 2.680544376373291, 2.68983793258667, 2.7106099128723145, 2.75142240524292, 2.7321221828460693, 2.721682071685791, 2.7176711559295654, 2.716799736022949, 2.721808910369873, 2.732667922973633, 2.7530415058135986, 2.793123960494995, 2.775800943374634, 2.7680375576019287, 2.7624170780181885, 2.765941858291626, 2.7729177474975586, 2.784947156906128, 2.8145105838775635, 2.8376455307006836, 2.826382875442505, 2.818889856338501, 2.8199901580810547, 2.8254799842834473, 2.8346333503723145, 2.855402946472168, 2.9005234241485596, 2.8879289627075195, 2.8808095455169678, 2.880260467529297, 2.8848421573638916, 2.8949484825134277, 2.915836811065674, 2.9671971797943115, 2.953725814819336, 2.948855400085449, 2.948495864868164, 2.953761577606201, 2.9672818183898926, 2.989670515060425, 3.0324690341949463, 3.022706985473633, 3.0199496746063232, 3.0230166912078857, 3.032059907913208, 3.050287961959839, 3.1178109645843506, 3.1059274673461914, 3.1004016399383545, 3.100194215774536, 3.1076927185058594, 3.1239206790924072, 3.202735185623169, 3.1887691020965576]

ranges = [2.6515121459960938, 2.6541378498077393, 2.5967280864715576, 2.568758249282837, 2.557253122329712, 2.550034284591675, 2.5474441051483154, 2.547794818878174, 2.554837703704834, 2.480123281478882, 2.4622416496276855, 2.45102596282959, 2.4497599601745605, 2.448007822036743, 2.449106216430664, 2.458120822906494, 2.3878417015075684, 2.3696727752685547, 2.358860492706299, 2.3536763191223145, 2.352905511856079, 2.3563122749328613, 2.3625242710113525, 2.3201451301574707, 2.290788412094116, 2.277456521987915, 2.2698299884796143, 2.2656285762786865, 2.264326810836792, 2.2663004398345947, 2.273911714553833, 2.2549190521240234, 2.212975025177002, 2.1986536979675293, 2.187713861465454, 2.1842737197875977, 2.1828396320343018, 2.1852269172668457, 2.1867852210998535, 2.1960222721099854, 2.1604015827178955, 2.133516311645508, 2.1210997104644775, 2.1138968467712402, 2.1096444129943848, 2.1090004444122314, 2.1106059551239014, 2.1127912998199463, 2.1212658882141113, 2.134166717529297, 2.0743372440338135, 2.0614349842071533, 2.0496556758880615, 2.045461416244507, 2.0429604053497314, 2.0427355766296387, 2.044769287109375, 2.0486693382263184, 2.0586514472961426, 2.0731306076049805, 2.0164377689361572, 1.999416708946228, 1.9939508438110352, 1.9872305393218994, 1.9831644296646118, 1.9826878309249878, 1.9861499071121216, 1.9911510944366455, 1.9992181062698364, 2.008974075317383, 1.9824658632278442, 1.960815668106079, 1.949455738067627, 1.9414819478988647, 1.9355871677398682, 1.9355392456054688, 1.9366673231124878, 1.939828872680664, 1.944961667060852, 1.9545559883117676, 1.9689217805862427, 1.9462330341339111, 1.9215859174728394, 1.9124726057052612, 1.9040448665618896, 1.8999695777893066, 1.8973935842514038, 1.8977913856506348, 1.8990691900253296, 1.903856873512268, 1.9122059345245361, 1.9256911277770996, 1.9492346048355103, 1.903963565826416, 1.8877545595169067, 1.8787789344787598, 1.8752626180648804, 1.8732270002365112, 1.8699766397476196, 1.8721590042114258, 1.8764985799789429, 1.880368709564209, 1.890368938446045, 1.9066648483276367, 1.9057750701904297, 1.8833006620407104, 1.869696855545044, 1.8621362447738647, 1.8547255992889404, 1.8556376695632935, 1.8541276454925537, 1.8561028242111206, 1.860739827156067, 1.868040680885315, 1.8780043125152588, 1.896973729133606, 1.8971989154815674, 1.8765604496002197, 1.8643888235092163, 1.857751727104187, 1.851963996887207, 1.8517245054244995, 1.8494272232055664, 1.8544938564300537, 1.8575297594070435, 1.8613698482513428, 1.8749725818634033, 1.8927074670791626, 1.9004048109054565, 1.881103277206421, 1.87087881565094, 1.8647338151931763, 1.8605804443359375, 1.8579519987106323, 1.8575286865234375, 1.8612709045410156, 1.8641762733459473, 1.8728758096694946, 1.8845691680908203, 1.908250093460083, 1.9124248027801514, 1.8959417343139648, 1.8861538171768188, 1.8819730281829834, 1.8784775733947754, 1.8773415088653564, 1.8784748315811157, 1.87895667552948, 1.8858600854873657, 1.8947700262069702, 1.9101232290267944, 1.9572181701660156, 1.9349911212921143, 1.9209550619125366, 1.9143401384353638, 1.9103144407272339, 1.9068176746368408, 1.9049022197723389, 1.9102084636688232, 1.914720058441162, 1.9202802181243896, 1.9345890283584595, 1.957110047340393, 1.976826548576355, 1.9627918004989624, 1.9549168348312378, 1.9499201774597168, 1.9463927745819092, 1.9476367235183716, 1.94988214969635, 1.9560937881469727, 1.9624727964401245, 1.9760377407073975, 2.002516031265259, 2.02028751373291, 2.0103509426116943, 2.0044398307800293, 1.998516321182251, 1.9982866048812866, 2.000035285949707, 2.0031466484069824, 2.0098116397857666, 2.0210118293762207, 2.041110038757324, 2.0818629264831543, 2.0714468955993652, 2.0639090538024902, 2.0582518577575684, 2.0581376552581787, 2.059041976928711, 2.063758611679077, 2.069380283355713, 2.0831730365753174, 2.104792356491089, 2.145014524459839, 2.1346750259399414, 2.1290245056152344, 2.128486156463623, 2.1256797313690186, 2.1316776275634766, 2.137946367263794, 2.14884352684021, 2.1670284271240234, 2.2192654609680176, 2.210127830505371, 2.2048022747039795, 2.2030656337738037, 2.2054266929626465, 2.208265542984009, 2.2165613174438477, 2.229205369949341, 2.257474422454834, 2.296325445175171, 2.2903451919555664, 2.2865872383117676, 2.288769245147705, 2.292034387588501, 2.2999818325042725, 2.313570261001587, 2.3408055305480957, 2.385089635848999, 2.3786871433258057, 2.378950834274292, 2.378965377807617, 2.384798526763916, 2.395657777786255, 2.4143314361572266, 2.480825185775757, 2.474325180053711, 2.4726266860961914, 2.4749739170074463, 2.4822866916656494, 2.491880178451538, 2.512742280960083, 2.5790607929229736, 2.574343204498291, 2.574152708053589, 2.579235315322876, 2.586878538131714, 2.6036009788513184, 2.685602903366089, 2.681551933288574, 2.6781818866729736, 2.6831772327423096, 2.692591667175293, 2.7105188369750977, 2.791442394256592, 2.7891783714294434, 2.7895805835723877, 2.7973220348358154, 2.8109703063964844, 2.841438055038452, 2.901073694229126, 2.903435707092285, 2.9095427989959717, 2.9215469360351562, 2.9533724784851074, 3.016862154006958, 3.018786907196045, 3.026707172393799, 2.9557056427001953, 2.937049150466919, 2.9292092323303223, 2.92641282081604, 2.9295103549957275, 2.935335874557495, 2.9516921043395996, 3.0458617210388184, 3.048262119293213, 3.0543997287750244, 3.069845199584961, 3.1069366931915283, 3.1750357151031494, 3.1791036128997803, 3.1976120471954346, 3.521178960800171, 3.551704168319702, 3.6352787017822266, 3.6440529823303223, 3.666750431060791, 3.7635436058044434, 3.0458195209503174, 3.030093193054199, 3.021287441253662, 2.8417961597442627, 2.8247458934783936, 2.8187005519866943, 2.8172667026519775, 2.817692756652832, 2.8269617557525635, 2.841914176940918, 2.9498260021209717, 2.9553537368774414, 2.969332695007324, 2.998964548110962, 4.565134048461914, 4.583192825317383, 4.702301502227783, 4.7212629318237305, 4.841303825378418, 4.864908695220947, 4.984768390655518, 4.9792985916137695, 4.93242073059082, 4.920090198516846, 3.4800548553466797, 3.4565165042877197, 3.448432683944702, 3.4464831352233887, 3.4522900581359863, 3.4663314819335938, 3.4414267539978027, 3.4132511615753174, 3.402639389038086, 3.3993747234344482, 3.40561842918396, 3.4158577919006348, 3.4446260929107666, 3.5637295246124268, 6.507595539093018, math.inf, math.inf, math.inf, 5.8562822341918945, 5.805086612701416, 5.795831203460693, 5.808673858642578, 5.958698749542236, 5.940236568450928, 5.9141340255737305, 5.9147562980651855, 5.9401726722717285, math.inf, math.inf, 2.8575756549835205, 2.838266372680664, 2.8292787075042725, 2.8265931606292725, 2.8268895149230957, 2.833629846572876, 2.849561929702759, 2.6867504119873047, 2.6702816486358643, 2.659546375274658, 2.658684253692627, 2.659625291824341, 2.662832260131836, 2.6770997047424316, 2.6976919174194336, 2.6835505962371826, 2.664973258972168, 2.652240514755249, 2.649858236312866, 2.646474838256836, 2.6529338359832764, 2.6594061851501465, 2.6751625537872314, 3.002121686935425, 5.830077171325684, math.inf, math.inf, math.inf, math.inf, 4.936922073364258, 4.906032085418701, 4.89779806137085, 4.905399322509766, 4.934155464172363, 4.9263811111450195, 4.907613754272461, 4.90554666519165, 4.920683860778809, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, 4.216701507568359, 4.195214748382568, 4.192035675048828, 4.194107532501221, 4.212963104248047, 4.254363059997559, 4.1038360595703125, 4.077637672424316, 4.068950176239014, 4.069999694824219, 4.0811448097229, 4.118815898895264, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, 3.158396005630493, 3.1405043601989746, 3.1319990158081055, 3.1311123371124268, 3.1348259449005127, 3.1439945697784424, 3.168175220489502, 3.2044944763183594, 3.1900272369384766, 3.1840951442718506, 3.184445858001709, 3.1914432048797607, 3.2053287029266357, 3.3809971809387207, 3.3834049701690674, 3.3948473930358887, 3.4179153442382812, 4.41416597366333, 4.465003490447998, 4.450897693634033, 4.335550308227539, 4.316653728485107, 4.314718246459961, 4.320235252380371, 4.344963073730469, 4.396609306335449, 4.3857316970825195, 4.2769012451171875, 4.256965160369873, 4.251911163330078, 4.258549213409424, 4.27852201461792, 4.341676712036133, 4.327922821044922, 4.234334468841553, 4.208475589752197, 4.200026035308838, 4.103518486022949, 4.081223487854004, 4.074413299560547, 4.078679084777832, 4.090404510498047, 4.175411224365234, 4.161439418792725, 4.158623218536377, 4.056301593780518, 4.0401787757873535, 4.035684108734131, 3.9454824924468994, 3.9241139888763428, 3.917647123336792, 3.855309247970581, 3.8139097690582275, 3.301008701324463, 3.273566484451294, 3.2621676921844482, 3.259661912918091, 3.261037588119507, 3.272308826446533, 3.2939982414245605, 3.362009286880493, 3.357163906097412, 3.3603262901306152, 3.2780072689056396, 3.257302761077881, 3.2485761642456055, 3.247354507446289, 3.2516539096832275, 3.26263689994812, 3.293672800064087, 3.3538286685943604, 3.3493242263793945, 3.359025716781616, 3.2684412002563477, 3.2528493404388428, 3.2462167739868164, 3.2472469806671143, 3.2524826526641846, 3.170473337173462, 3.155085802078247, 3.1467537879943848, 3.1471192836761475, 3.1518383026123047, 3.0875892639160156, 3.064742088317871, 3.0522661209106445, 3.050381898880005, 3.0501043796539307, 3.0570247173309326, 2.989086866378784, 2.969270944595337, 2.9609129428863525, 2.9572672843933105, 2.959132194519043, 2.9656176567077637, 2.903859853744507, 2.885037422180176, 2.876354932785034, 2.8690505027770996, 2.8687069416046143, 2.8763835430145264, 2.8455278873443604, 2.810948610305786, 2.7946510314941406, 2.7885167598724365, 2.7869131565093994, 2.790541172027588, 2.796689987182617, 2.7587954998016357, 2.7323219776153564, 2.718132495880127, 2.713770627975464, 2.710129737854004, 2.7113232612609863, 2.7210936546325684, 2.735468864440918, 2.6648197174072266, 2.650108814239502, 2.6428725719451904, 2.638425588607788, 2.640939712524414, 2.6464426517486572, 2.657533645629883, 2.6176748275756836, 2.5938475131988525, 2.5827369689941406, 2.5757482051849365, 2.5763635635375977, 2.578833818435669, 2.5842511653900146, 2.5949807167053223, 2.5641093254089355, 2.5380496978759766, 2.5243570804595947, 2.519167423248291, 2.5186147689819336, 2.5202393531799316, 2.525251626968384, 2.536965847015381, 2.5295255184173584, 2.494471549987793, 2.4808835983276367, 2.4722676277160645, 2.4679245948791504, 2.468714714050293, 2.473496913909912, 2.481968641281128, 2.499309778213501, 2.4691824913024902, 2.4480693340301514, 2.436861276626587, 2.4313430786132812, 2.427569627761841, 2.4288322925567627, 2.43442702293396, 2.4434189796447754, 2.461695671081543, 2.434924364089966, 2.4162561893463135, 2.4040260314941406, 2.398289680480957, 2.3945705890655518, 2.3966224193573, 2.4002602100372314, 2.411367893218994, 2.4269800186157227, 2.416034698486328, 2.391592502593994, 2.381270408630371, 2.3746514320373535, 2.3703527450561523, 2.372565984725952, 2.3755218982696533, 2.3845272064208984, 2.3998472690582275, 2.420210599899292, 2.3819680213928223, 2.3689844608306885, 2.360167980194092, 2.3556089401245117, 2.3554670810699463, 2.35984468460083, 2.3658103942871094, 2.3777694702148438, 2.4022819995880127, 2.3869032859802246, 2.3671250343322754, 2.35776948928833, 2.352841377258301, 2.350377082824707, 2.351043701171875, 2.356952428817749, 2.3666200637817383, 2.382493495941162, 2.406245231628418, 2.378523111343384, 2.364126205444336, 2.3557634353637695, 2.3526594638824463, 2.3545680046081543, 2.3566293716430664, 2.364682674407959, 2.3776540756225586, 2.4052846431732178, 2.3985648155212402, 2.3821592330932617, 2.3725194931030273, 2.369288682937622, 2.3657543659210205, 2.3698174953460693, 2.3741958141326904, 2.3855361938476562, 2.403704881668091, 2.4262382984161377, 2.408470392227173, 2.3952417373657227, 2.388763904571533, 2.387032985687256, 2.388502597808838, 2.3938748836517334, 2.4022982120513916, 2.4196431636810303, 2.462009906768799, 2.4396562576293945, 2.4269423484802246, 2.421480655670166, 2.4176089763641357, 2.4195101261138916, 2.4260735511779785, 2.4333057403564453, 2.4511020183563232, 2.4954633712768555, 2.4763238430023193, 2.464649200439453, 2.460574150085449, 2.457444190979004, 2.458066701889038, 2.464963912963867, 2.4768056869506836, 2.499138832092285, 2.533243179321289, 2.516467809677124, 2.506943941116333, 2.5039265155792236, 2.5064618587493896, 2.50807785987854, 2.518038511276245, 2.533775806427002, 2.5929224491119385, 2.5753703117370605, 2.5628201961517334, 2.56278920173645, 2.560910701751709, 2.5633625984191895, 2.5710270404815674, 2.5868842601776123, 2.6512463092803955, 2.6356499195098877, 2.625898838043213, 2.6211962699890137, 2.622771978378296, 2.6265413761138916, 2.6364216804504395, 2.6562716960906982, 2.712331771850586, 2.699640989303589, 2.690728187561035, 2.6909232139587402, 2.6943652629852295, 2.701591730117798, 2.7166495323181152, 2.758883237838745, 2.775357723236084, 2.766303062438965, 2.7654032707214355, 2.7694177627563477, 2.77760910987854, 2.7922046184539795, 2.8660614490509033, 2.853215217590332, 2.8475430011749268, 2.847827434539795, 2.8521957397460938, 2.863530397415161, 2.8823201656341553, 2.9439375400543213, 2.9374470710754395, 2.932715654373169, 2.936711311340332, 2.9459400177001953, 2.963257074356079, 3.034763813018799, 3.027865409851074, 3.023850202560425, 3.0293383598327637, 3.0358479022979736, 3.0588908195495605, 3.128187894821167, 3.1190667152404785, 3.120521306991577, 3.126303195953369, 3.140957832336426, 3.176783561706543, 3.221374988555908, 3.221783399581909, 3.2264952659606934, 3.2357687950134277, 3.2658846378326416, 3.3271749019622803, 3.3225111961364746, 3.328554391860962]

# points = []

# for i in range (0, 100):
#     point = [random.uniform(0, 10), random.uniform(0, 10)]
#     points.append(point)

points = ranges_to_coordinates(ranges, angle_min + yaw, angle_increment)


for i in range(len(points)):
    x, y = points[i]
    x += -0.055  # hardcoded laser -> base_link
    x = round(x  * 10 / 2) *2   # scale by 10, discretize by 2, make it an int
    y = round(y * 10 /2) *2
    points[i] = (x, y)

points1 = [(0,100), (0,0), (-50,-10),(-40,-10), (50,-10)]
vor = Voronoi(points1, incremental = True)
vor.add_points(points)
# points2 = [(x*2, -10) for x in range (-15, 15)]
# points2 = generate_arc_points(-math.pi/2, 0, 10, 10)
points2 = generate_ellipse_arc(20, 15, -math.pi, 0, 20)
# vor1 = vor
vor.add_points(points2)
# points1+=points
# points = points1 + points2

fig = voronoi_plot_2d(vor)
# plt.show()


start = (0, 0)
goal = (100*math.cos(yaw), 100* math.sin(yaw))
pdb.set_trace()
map = get_edge_map2(vor, (0,0))
for p in vor.regions[vor.point_region[0]]:
    print(p, vor.vertices[p][0], vor.vertices[p][1])

# print(map)
# for e in edges:
#     print(vertices[e[0]], vertices[e[1]])


rx = [p[0] for p in points]
ry = [p[1] for p in points]
plt.plot(rx, ry, 'ko')
pdb.set_trace()
vor_vertices = np.append(vor.vertices, [[0,0]], axis=0)
vor_vertices = np.append(vor_vertices, [[0,100]], axis=0)
old_path = a_star(len(vor.vertices), len(vor.vertices)+1, map, vor_vertices, None)
path = a_star(len(vor.vertices), len(vor.vertices)+1, map, vor_vertices, old_path)

print(path)
x = [p[0] for p in path]
y = [p[1] for p in path]
plt.plot(x, y, 'bo')

# tck, u = interpolate.splprep([x, y])
# x_i, y_i = interpolate.splev(np.linspace(0, 1, 100), tck)

# plt.plot(x_i, y_i, 'r')


plt.plot([start[0], goal[0]], [start[1], goal[1]], 'go')
plt.axis([-50, 50, -30, 110])
# plt.savefig("test2.png")
plt.show()