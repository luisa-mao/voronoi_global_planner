import matplotlib.pyplot as plt
from matplotlib.path import Path as mPath
import numpy as np
from vor_utils import *



px= 0.019715886563062668
py= 1.4044371843338013
pz= 0.0
#     orientation: 
qx= 0.0
qy= 0.0
qz= 0.6813265229028491
qw= 0.7319796234794473

yaw = math.atan2(2 * (qw*qz + qx*qy), 1 - 2 * (qy*qy + qz*qz))

angle_min = -2.3561899662017822
angle_max = 2.3561899662017822
angle_increment = 0.006554075051099062


ranges = [2.6515121459960938, 2.6541378498077393, 2.5967280864715576, 2.568758249282837, 2.557253122329712, 2.550034284591675, 2.5474441051483154, 2.547794818878174, 2.554837703704834, 2.480123281478882, 2.4622416496276855, 2.45102596282959, 2.4497599601745605, 2.448007822036743, 2.449106216430664, 2.458120822906494, 2.3878417015075684, 2.3696727752685547, 2.358860492706299, 2.3536763191223145, 2.352905511856079, 2.3563122749328613, 2.3625242710113525, 2.3201451301574707, 2.290788412094116, 2.277456521987915, 2.2698299884796143, 2.2656285762786865, 2.264326810836792, 2.2663004398345947, 2.273911714553833, 2.2549190521240234, 2.212975025177002, 2.1986536979675293, 2.187713861465454, 2.1842737197875977, 2.1828396320343018, 2.1852269172668457, 2.1867852210998535, 2.1960222721099854, 2.1604015827178955, 2.133516311645508, 2.1210997104644775, 2.1138968467712402, 2.1096444129943848, 2.1090004444122314, 2.1106059551239014, 2.1127912998199463, 2.1212658882141113, 2.134166717529297, 2.0743372440338135, 2.0614349842071533, 2.0496556758880615, 2.045461416244507, 2.0429604053497314, 2.0427355766296387, 2.044769287109375, 2.0486693382263184, 2.0586514472961426, 2.0731306076049805, 2.0164377689361572, 1.999416708946228, 1.9939508438110352, 1.9872305393218994, 1.9831644296646118, 1.9826878309249878, 1.9861499071121216, 1.9911510944366455, 1.9992181062698364, 2.008974075317383, 1.9824658632278442, 1.960815668106079, 1.949455738067627, 1.9414819478988647, 1.9355871677398682, 1.9355392456054688, 1.9366673231124878, 1.939828872680664, 1.944961667060852, 1.9545559883117676, 1.9689217805862427, 1.9462330341339111, 1.9215859174728394, 1.9124726057052612, 1.9040448665618896, 1.8999695777893066, 1.8973935842514038, 1.8977913856506348, 1.8990691900253296, 1.903856873512268, 1.9122059345245361, 1.9256911277770996, 1.9492346048355103, 1.903963565826416, 1.8877545595169067, 1.8787789344787598, 1.8752626180648804, 1.8732270002365112, 1.8699766397476196, 1.8721590042114258, 1.8764985799789429, 1.880368709564209, 1.890368938446045, 1.9066648483276367, 1.9057750701904297, 1.8833006620407104, 1.869696855545044, 1.8621362447738647, 1.8547255992889404, 1.8556376695632935, 1.8541276454925537, 1.8561028242111206, 1.860739827156067, 1.868040680885315, 1.8780043125152588, 1.896973729133606, 1.8971989154815674, 1.8765604496002197, 1.8643888235092163, 1.857751727104187, 1.851963996887207, 1.8517245054244995, 1.8494272232055664, 1.8544938564300537, 1.8575297594070435, 1.8613698482513428, 1.8749725818634033, 1.8927074670791626, 1.9004048109054565, 1.881103277206421, 1.87087881565094, 1.8647338151931763, 1.8605804443359375, 1.8579519987106323, 1.8575286865234375, 1.8612709045410156, 1.8641762733459473, 1.8728758096694946, 1.8845691680908203, 1.908250093460083, 1.9124248027801514, 1.8959417343139648, 1.8861538171768188, 1.8819730281829834, 1.8784775733947754, 1.8773415088653564, 1.8784748315811157, 1.87895667552948, 1.8858600854873657, 1.8947700262069702, 1.9101232290267944, 1.9572181701660156, 1.9349911212921143, 1.9209550619125366, 1.9143401384353638, 1.9103144407272339, 1.9068176746368408, 1.9049022197723389, 1.9102084636688232, 1.914720058441162, 1.9202802181243896, 1.9345890283584595, 1.957110047340393, 1.976826548576355, 1.9627918004989624, 1.9549168348312378, 1.9499201774597168, 1.9463927745819092, 1.9476367235183716, 1.94988214969635, 1.9560937881469727, 1.9624727964401245, 1.9760377407073975, 2.002516031265259, 2.02028751373291, 2.0103509426116943, 2.0044398307800293, 1.998516321182251, 1.9982866048812866, 2.000035285949707, 2.0031466484069824, 2.0098116397857666, 2.0210118293762207, 2.041110038757324, 2.0818629264831543, 2.0714468955993652, 2.0639090538024902, 2.0582518577575684, 2.0581376552581787, 2.059041976928711, 2.063758611679077, 2.069380283355713, 2.0831730365753174, 2.104792356491089, 2.145014524459839, 2.1346750259399414, 2.1290245056152344, 2.128486156463623, 2.1256797313690186, 2.1316776275634766, 2.137946367263794, 2.14884352684021, 2.1670284271240234, 2.2192654609680176, 2.210127830505371, 2.2048022747039795, 2.2030656337738037, 2.2054266929626465, 2.208265542984009, 2.2165613174438477, 2.229205369949341, 2.257474422454834, 2.296325445175171, 2.2903451919555664, 2.2865872383117676, 2.288769245147705, 2.292034387588501, 2.2999818325042725, 2.313570261001587, 2.3408055305480957, 2.385089635848999, 2.3786871433258057, 2.378950834274292, 2.378965377807617, 2.384798526763916, 2.395657777786255, 2.4143314361572266, 2.480825185775757, 2.474325180053711, 2.4726266860961914, 2.4749739170074463, 2.4822866916656494, 2.491880178451538, 2.512742280960083, 2.5790607929229736, 2.574343204498291, 2.574152708053589, 2.579235315322876, 2.586878538131714, 2.6036009788513184, 2.685602903366089, 2.681551933288574, 2.6781818866729736, 2.6831772327423096, 2.692591667175293, 2.7105188369750977, 2.791442394256592, 2.7891783714294434, 2.7895805835723877, 2.7973220348358154, 2.8109703063964844, 2.841438055038452, 2.901073694229126, 2.903435707092285, 2.9095427989959717, 2.9215469360351562, 2.9533724784851074, 3.016862154006958, 3.018786907196045, 3.026707172393799, 2.9557056427001953, 2.937049150466919, 2.9292092323303223, 2.92641282081604, 2.9295103549957275, 2.935335874557495, 2.9516921043395996, 3.0458617210388184, 3.048262119293213, 3.0543997287750244, 3.069845199584961, 3.1069366931915283, 3.1750357151031494, 3.1791036128997803, 3.1976120471954346, 3.521178960800171, 3.551704168319702, 3.6352787017822266, 3.6440529823303223, 3.666750431060791, 3.7635436058044434, 3.0458195209503174, 3.030093193054199, 3.021287441253662, 2.8417961597442627, 2.8247458934783936, 2.8187005519866943, 2.8172667026519775, 2.817692756652832, 2.8269617557525635, 2.841914176940918, 2.9498260021209717, 2.9553537368774414, 2.969332695007324, 2.998964548110962, 4.565134048461914, 4.583192825317383, 4.702301502227783, 4.7212629318237305, 4.841303825378418, 4.864908695220947, 4.984768390655518, 4.9792985916137695, 4.93242073059082, 4.920090198516846, 3.4800548553466797, 3.4565165042877197, 3.448432683944702, 3.4464831352233887, 3.4522900581359863, 3.4663314819335938, 3.4414267539978027, 3.4132511615753174, 3.402639389038086, 3.3993747234344482, 3.40561842918396, 3.4158577919006348, 3.4446260929107666, 3.5637295246124268, 6.507595539093018, math.inf, math.inf, math.inf, 5.8562822341918945, 5.805086612701416, 5.795831203460693, 5.808673858642578, 5.958698749542236, 5.940236568450928, 5.9141340255737305, 5.9147562980651855, 5.9401726722717285, math.inf, math.inf, 2.8575756549835205, 2.838266372680664, 2.8292787075042725, 2.8265931606292725, 2.8268895149230957, 2.833629846572876, 2.849561929702759, 2.6867504119873047, 2.6702816486358643, 2.659546375274658, 2.658684253692627, 2.659625291824341, 2.662832260131836, 2.6770997047424316, 2.6976919174194336, 2.6835505962371826, 2.664973258972168, 2.652240514755249, 2.649858236312866, 2.646474838256836, 2.6529338359832764, 2.6594061851501465, 2.6751625537872314, 3.002121686935425, 5.830077171325684, math.inf, math.inf, math.inf, math.inf, 4.936922073364258, 4.906032085418701, 4.89779806137085, 4.905399322509766, 4.934155464172363, 4.9263811111450195, 4.907613754272461, 4.90554666519165, 4.920683860778809, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, 4.216701507568359, 4.195214748382568, 4.192035675048828, 4.194107532501221, 4.212963104248047, 4.254363059997559, 4.1038360595703125, 4.077637672424316, 4.068950176239014, 4.069999694824219, 4.0811448097229, 4.118815898895264, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, math.inf, 3.158396005630493, 3.1405043601989746, 3.1319990158081055, 3.1311123371124268, 3.1348259449005127, 3.1439945697784424, 3.168175220489502, 3.2044944763183594, 3.1900272369384766, 3.1840951442718506, 3.184445858001709, 3.1914432048797607, 3.2053287029266357, 3.3809971809387207, 3.3834049701690674, 3.3948473930358887, 3.4179153442382812, 4.41416597366333, 4.465003490447998, 4.450897693634033, 4.335550308227539, 4.316653728485107, 4.314718246459961, 4.320235252380371, 4.344963073730469, 4.396609306335449, 4.3857316970825195, 4.2769012451171875, 4.256965160369873, 4.251911163330078, 4.258549213409424, 4.27852201461792, 4.341676712036133, 4.327922821044922, 4.234334468841553, 4.208475589752197, 4.200026035308838, 4.103518486022949, 4.081223487854004, 4.074413299560547, 4.078679084777832, 4.090404510498047, 4.175411224365234, 4.161439418792725, 4.158623218536377, 4.056301593780518, 4.0401787757873535, 4.035684108734131, 3.9454824924468994, 3.9241139888763428, 3.917647123336792, 3.855309247970581, 3.8139097690582275, 3.301008701324463, 3.273566484451294, 3.2621676921844482, 3.259661912918091, 3.261037588119507, 3.272308826446533, 3.2939982414245605, 3.362009286880493, 3.357163906097412, 3.3603262901306152, 3.2780072689056396, 3.257302761077881, 3.2485761642456055, 3.247354507446289, 3.2516539096832275, 3.26263689994812, 3.293672800064087, 3.3538286685943604, 3.3493242263793945, 3.359025716781616, 3.2684412002563477, 3.2528493404388428, 3.2462167739868164, 3.2472469806671143, 3.2524826526641846, 3.170473337173462, 3.155085802078247, 3.1467537879943848, 3.1471192836761475, 3.1518383026123047, 3.0875892639160156, 3.064742088317871, 3.0522661209106445, 3.050381898880005, 3.0501043796539307, 3.0570247173309326, 2.989086866378784, 2.969270944595337, 2.9609129428863525, 2.9572672843933105, 2.959132194519043, 2.9656176567077637, 2.903859853744507, 2.885037422180176, 2.876354932785034, 2.8690505027770996, 2.8687069416046143, 2.8763835430145264, 2.8455278873443604, 2.810948610305786, 2.7946510314941406, 2.7885167598724365, 2.7869131565093994, 2.790541172027588, 2.796689987182617, 2.7587954998016357, 2.7323219776153564, 2.718132495880127, 2.713770627975464, 2.710129737854004, 2.7113232612609863, 2.7210936546325684, 2.735468864440918, 2.6648197174072266, 2.650108814239502, 2.6428725719451904, 2.638425588607788, 2.640939712524414, 2.6464426517486572, 2.657533645629883, 2.6176748275756836, 2.5938475131988525, 2.5827369689941406, 2.5757482051849365, 2.5763635635375977, 2.578833818435669, 2.5842511653900146, 2.5949807167053223, 2.5641093254089355, 2.5380496978759766, 2.5243570804595947, 2.519167423248291, 2.5186147689819336, 2.5202393531799316, 2.525251626968384, 2.536965847015381, 2.5295255184173584, 2.494471549987793, 2.4808835983276367, 2.4722676277160645, 2.4679245948791504, 2.468714714050293, 2.473496913909912, 2.481968641281128, 2.499309778213501, 2.4691824913024902, 2.4480693340301514, 2.436861276626587, 2.4313430786132812, 2.427569627761841, 2.4288322925567627, 2.43442702293396, 2.4434189796447754, 2.461695671081543, 2.434924364089966, 2.4162561893463135, 2.4040260314941406, 2.398289680480957, 2.3945705890655518, 2.3966224193573, 2.4002602100372314, 2.411367893218994, 2.4269800186157227, 2.416034698486328, 2.391592502593994, 2.381270408630371, 2.3746514320373535, 2.3703527450561523, 2.372565984725952, 2.3755218982696533, 2.3845272064208984, 2.3998472690582275, 2.420210599899292, 2.3819680213928223, 2.3689844608306885, 2.360167980194092, 2.3556089401245117, 2.3554670810699463, 2.35984468460083, 2.3658103942871094, 2.3777694702148438, 2.4022819995880127, 2.3869032859802246, 2.3671250343322754, 2.35776948928833, 2.352841377258301, 2.350377082824707, 2.351043701171875, 2.356952428817749, 2.3666200637817383, 2.382493495941162, 2.406245231628418, 2.378523111343384, 2.364126205444336, 2.3557634353637695, 2.3526594638824463, 2.3545680046081543, 2.3566293716430664, 2.364682674407959, 2.3776540756225586, 2.4052846431732178, 2.3985648155212402, 2.3821592330932617, 2.3725194931030273, 2.369288682937622, 2.3657543659210205, 2.3698174953460693, 2.3741958141326904, 2.3855361938476562, 2.403704881668091, 2.4262382984161377, 2.408470392227173, 2.3952417373657227, 2.388763904571533, 2.387032985687256, 2.388502597808838, 2.3938748836517334, 2.4022982120513916, 2.4196431636810303, 2.462009906768799, 2.4396562576293945, 2.4269423484802246, 2.421480655670166, 2.4176089763641357, 2.4195101261138916, 2.4260735511779785, 2.4333057403564453, 2.4511020183563232, 2.4954633712768555, 2.4763238430023193, 2.464649200439453, 2.460574150085449, 2.457444190979004, 2.458066701889038, 2.464963912963867, 2.4768056869506836, 2.499138832092285, 2.533243179321289, 2.516467809677124, 2.506943941116333, 2.5039265155792236, 2.5064618587493896, 2.50807785987854, 2.518038511276245, 2.533775806427002, 2.5929224491119385, 2.5753703117370605, 2.5628201961517334, 2.56278920173645, 2.560910701751709, 2.5633625984191895, 2.5710270404815674, 2.5868842601776123, 2.6512463092803955, 2.6356499195098877, 2.625898838043213, 2.6211962699890137, 2.622771978378296, 2.6265413761138916, 2.6364216804504395, 2.6562716960906982, 2.712331771850586, 2.699640989303589, 2.690728187561035, 2.6909232139587402, 2.6943652629852295, 2.701591730117798, 2.7166495323181152, 2.758883237838745, 2.775357723236084, 2.766303062438965, 2.7654032707214355, 2.7694177627563477, 2.77760910987854, 2.7922046184539795, 2.8660614490509033, 2.853215217590332, 2.8475430011749268, 2.847827434539795, 2.8521957397460938, 2.863530397415161, 2.8823201656341553, 2.9439375400543213, 2.9374470710754395, 2.932715654373169, 2.936711311340332, 2.9459400177001953, 2.963257074356079, 3.034763813018799, 3.027865409851074, 3.023850202560425, 3.0293383598327637, 3.0358479022979736, 3.0588908195495605, 3.128187894821167, 3.1190667152404785, 3.120521306991577, 3.126303195953369, 3.140957832336426, 3.176783561706543, 3.221374988555908, 3.221783399581909, 3.2264952659606934, 3.2357687950134277, 3.2658846378326416, 3.3271749019622803, 3.3225111961364746, 3.328554391860962]


# Define the points of the polygon
# points = np.array([(0, 0), (1, 1), (1,0), (1.5,1), (2, 0), (1, -1)])

points = ranges_to_coordinates(ranges, angle_min + yaw, angle_increment)

# for i in range(len(points)):
#     x, y = points[i]
#     # x += -0.055 + shift_x # hardcoded laser -> base_link
#     # y += shift_y
#     x = round(x  * 10 / 2) *2   # scale by 10, discretize by 2, make it an int
#     y = round(y * 10 /2) *2
#     points[i] = (x, y)

# polygon = matplotlib.path.Path([start]+points)

points2 = np.array([(0, 0), (-1,-1), (0,-1), (.1,-1),(10, 1), (.5,0)])
# Create a Path object from the points

polygon_path = mPath([(0,0)]+points+[(0,0)])

for p in points2:
    print(polygon_path.contains_point(p))

# Generate a figure and axis objects
fig, ax = plt.subplots()

# Plot the polygon using the Path object
patch = plt.Polygon(points, alpha=0.5)
ax.add_patch(patch)

# Set the limits of the plot
ax.set_xlim([-10, 10])
ax.set_ylim([-10, 10])

# Add labels to the plot
ax.set_title('Polygon Example')
ax.set_xlabel('X')
ax.set_ylabel('Y')

rx = [p[0] for p in points]
ry = [p[1] for p in points]
plt.plot(rx, ry, 'ko')

# Display the plot
plt.show()